{% extends "layout.html" %} {% block content %}

<div class="row mb-4">
  <div class="col-12 text-center">
    <h2 class="fw-bold text-primary">
      <i class="fa-solid fa-microscope me-2"></i>Veri Analizi ve Ä°statistikler
    </h2>
    <p class="text-muted">
      Bu bÃ¶lÃ¼mde, veri setindeki deÄŸiÅŸkenler arasÄ±ndaki iliÅŸkiler farklÄ±
      istatistiksel yÃ¶ntemlerle incelenmiÅŸtir. (Kaynak: Ders NotlarÄ± -
      Correlation & Categorical Data Analysis)
    </p>
  </div>
</div>

<ul class="nav nav-tabs nav-justified mb-3" id="analysisTab" role="tablist">
  <li class="nav-item" role="presentation">
    <button
      class="nav-link active"
      id="numeric-tab"
      data-bs-toggle="tab"
      data-bs-target="#numeric"
      type="button"
      role="tab"
    >
      <i class="fa-solid fa-calculator me-1"></i>SayÄ±sal Korelasyonlar
    </button>
  </li>

  <li class="nav-item" role="presentation">
    <button
      class="nav-link"
      id="categorical-tab"
      data-bs-toggle="tab"
      data-bs-target="#categorical"
      type="button"
      role="tab"
    >
      <i class="fa-solid fa-shapes me-1"></i>Kategorik (Cramer's V)
    </button>
  </li>

  <li class="nav-item" role="presentation">
    <button
      class="nav-link"
      id="info-tab"
      data-bs-toggle="tab"
      data-bs-target="#info"
      type="button"
      role="tab"
    >
      <i class="fa-solid fa-book-open me-1"></i>Akademik Rapor & TutarlÄ±lÄ±k
    </button>
  </li>
</ul>

<div
  class="tab-content p-4 border border-top-0 bg-white shadow-sm rounded-bottom"
  id="myTabContent"
>
  <div class="tab-pane fade show active" id="numeric" role="tabpanel">
    <div class="alert alert-light border-start border-4 border-primary">
      <strong>Bilgi:</strong> AÅŸaÄŸÄ±daki matrisler, sayÄ±sal deÄŸiÅŸkenlerin
      birbirleriyle olan iliÅŸkisini gÃ¶sterir. (+1: MÃ¼kemmel Pozitif Ä°liÅŸki, -1:
      MÃ¼kemmel Negatif Ä°liÅŸki).
    </div>

    <div class="accordion" id="correlationAccordion">
      <div class="accordion-item">
        <h2 class="accordion-header">
          <button
            class="accordion-button"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapsePearson"
          >
            <strong>Pearson Korelasyonu</strong> (DoÄŸrusal Ä°liÅŸkiler Ä°Ã§in)
          </button>
        </h2>
        <div
          id="collapsePearson"
          class="accordion-collapse collapse show"
          data-bs-parent="#correlationAccordion"
        >
          <div class="accordion-body table-responsive small-font">
            {{ pearson_corr | safe }}
          </div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header">
          <button
            class="accordion-button collapsed"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseSpearman"
          >
            <strong>Spearman Korelasyonu</strong> (SÄ±ralÄ± Veriler ve Outlier
            Direnci Ä°Ã§in)
          </button>
        </h2>
        <div
          id="collapseSpearman"
          class="accordion-collapse collapse"
          data-bs-parent="#correlationAccordion"
        >
          <div class="accordion-body table-responsive small-font">
            {{ spearman_corr | safe }}
          </div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header">
          <button
            class="accordion-button collapsed"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseKendall"
          >
            <strong>Kendall's Tau</strong> (Alternatif SÄ±ralama Analizi)
          </button>
        </h2>
        <div
          id="collapseKendall"
          class="accordion-collapse collapse"
          data-bs-parent="#correlationAccordion"
        >
          <div class="accordion-body table-responsive small-font">
            {{ kendall_corr | safe }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane fade" id="categorical" role="tabpanel">
    <h5 class="mb-3 text-secondary">
      Fiyat Ãœzerindeki Kategorik Etkiler (0 ile 1 arasÄ±)
    </h5>

    <div class="row">
      {% for key, value in cat_corr.items() %}
      <div class="col-md-6 col-lg-4 mb-3">
        <div
          class="card h-100 border-{{ 'primary' if value > 0.3 else 'secondary' }}"
        >
          <div
            class="card-body d-flex justify-content-between align-items-center"
          >
            <div>
              <h6 class="card-title fw-bold mb-0">{{ key }}</h6>
              <small class="text-muted">vs Fiyat</small>
            </div>
            <span
              class="badge rounded-pill bg-{{ 'primary' if value > 0.3 else 'secondary' }} fs-6"
            >
              {{ value }}
            </span>
          </div>
          <div class="card-footer bg-transparent border-0 pt-0">
            <div class="progress" style="height: 5px">
              <div
                class="progress-bar bg-{{ 'primary' if value > 0.3 else 'secondary' }}"
                role="progressbar"
                style="width: {{ value * 100 }}%"
              ></div>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <div class="alert alert-info mt-3">
      <i class="fa-solid fa-info-circle me-2"></i>
      <strong>Bilgi:</strong> Cramer's V deÄŸeri 1'e yaklaÅŸtÄ±kÃ§a, kategorik
      deÄŸiÅŸkenin (Marka, Vites vb.) fiyat Ã¼zerindeki etkisi artar. Bu analiz,
      Nominal (Ä°simsel) verilerin fiyatlandÄ±rmadaki rolÃ¼nÃ¼ gÃ¶sterir.
    </div>
  </div>

  <div class="tab-pane fade" id="info" role="tabpanel">
    <div class="row mb-4">
      <div class="col-md-6">
        <div class="card h-100 shadow-sm">
          <div class="card-header fw-bold bg-primary text-white">
            <i class="fa-solid fa-question-circle me-2"></i>Neden FarklÄ±
            YÃ¶ntemler?
          </div>
          <div class="card-body">
            <ul class="list-group list-group-flush">
              <li class="list-group-item">
                <strong>Pearson:</strong> Verilerin normal daÄŸÄ±ldÄ±ÄŸÄ± ve
                iliÅŸkinin doÄŸrusal olduÄŸu durumlarda kullanÄ±lÄ±r. Outlier'lara
                karÅŸÄ± hassastÄ±r.
              </li>
              <li class="list-group-item">
                <strong>Spearman:</strong> Veriler sÄ±ralÄ±ysa (Ordinal) veya
                normal daÄŸÄ±lmÄ±yorsa kullanÄ±lÄ±r. Outlier'lardan daha az
                etkilenir.
              </li>
              <li class="list-group-item">
                <strong>Kendall's Tau:</strong> Veri seti kÃ¼Ã§Ã¼kse veya sÄ±ralama
                Ã§ok Ã¶nemliyse Spearman'dan daha tutarlÄ±dÄ±r.
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card h-100 shadow-sm">
          <div class="card-header fw-bold bg-success text-white">
            <i class="fa-solid fa-bullseye me-2"></i>Outlier (FÄ±rsat) Analizi
            YÃ¶ntemi
          </div>
          <div class="card-body">
            <p>
              Bu projede Outlier tespiti iÃ§in
              <strong>Residual Z-Score</strong> yÃ¶ntemi kullanÄ±lmÄ±ÅŸtÄ±r.
            </p>
            <p>
              Regresyon modelinin tahmin hatasÄ± (Residual), standart sapmaya
              bÃ¶lÃ¼nerek Z-Skoru elde edilmiÅŸtir. Z-Skoru
              <strong>-1.5'ten kÃ¼Ã§Ã¼k</strong> olan araÃ§lar, piyasanÄ±n altÄ±nda
              fiyatlandÄ±ÄŸÄ± iÃ§in "FÄ±rsat" olarak etiketlenmiÅŸtir.
            </p>
          </div>
        </div>
      </div>
    </div>

    <h4 class="fw-bold text-dark mb-3">
      ğŸ“Š YÃ¶ntemler ArasÄ± TutarlÄ±lÄ±k Analizi
    </h4>

    <div class="card border-{{ consistency.renk }} mb-3">
      <div class="card-header bg-{{ consistency.renk }} text-white fw-bold">
        Pearson vs Spearman KarÅŸÄ±laÅŸtÄ±rmasÄ±
      </div>
      <div class="card-body">
        <div class="row text-center align-items-center">
          <div class="col-md-4">
            <h6 class="text-muted">Ortalama Fark</h6>
            <h3 class="fw-bold">{{ consistency.fark }}</h3>
          </div>
          <div class="col-md-4">
            <h6 class="text-muted">Benzerlik (TutarlÄ±lÄ±k)</h6>
            <h3 class="fw-bold text-{{ consistency.renk }}">
              % {{ consistency.yuzde }}
            </h3>
          </div>
          <div class="col-md-4 text-start">
            <h6 class="text-muted">Otomatik Yorum</h6>
            <p class="mb-0">{{ consistency.yorum }}</p>
          </div>
        </div>
      </div>
      <div class="card-footer text-muted small">
        * Pearson ile Spearman arasÄ±ndaki fark arttÄ±kÃ§a, verideki doÄŸrusallÄ±ktan
        sapma ve aykÄ±rÄ± deÄŸer (Outlier) miktarÄ± artar.
      </div>
    </div>
  </div>
</div>

{% endblock %}
